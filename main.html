<!DOCTYPE html>
<html>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <!-- we import arjs version without NFT but with marker + location based support -->
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <script>AFRAME.registerComponent('clock-text', {
                schema: {
                    timer: {type: 'int', default: 20},
                },
                init: function() {
                    console.log('Timer init entered');
                    var el = this.el;
                    this.ready = false;
                    el.addEventListener('textfontset', function() {
                        this.ready = true;
                    }.bind(this));

                    this.TargetTime=new Date(date.getTime() +  this.data.timer*1000); //calulate the target time
                },
                TimeLeft: function(){
                    let CurrentDate = new Date();
                    CurrentDate = CurrentDate.getTime();
                    
                    let timeRemaining = parseInt((this.TargetTime - CurrentDate) / 1000);
                    
                    this.totalTimeRemaining=  timeRemaining*1000;
                    if (timeRemaining >= 0) {
                        timeRemaining = (timeRemaining % 86400);
                        
                        this.houra = parseInt(timeRemaining / 3600);
                        timeRemaining = (timeRemaining % 3600);
                        
                        this.minutea = parseInt(timeRemaining / 60);
                        timeRemaining = (timeRemaining % 60);
                        console.log("timeRemaining "+ timeRemaining);
                        
                        this.seconda = parseInt(timeRemaining);
                    }
                }
                ,
                tick: function() {
  	        	    var el = this.el;
                    if (!this.ready) {
    	                return;
                    }

                    this.TimeLeft();
                    if(this.houra == 0 && this.minutea == 0 && this.seconda == 0){
                        el.setAttribute('value', timeRem);
                        this.pause();
                    }else{
                        var timeRem = this.houra + " hrs " + this.minutea + " mins " + this.seconda + " secs ";
                    }
                    

                    /*var timer = setInterval(function() {
                        var currTime = new Date().getTime();

                        var diff = endTime - currTime;

                        if(diff > 0) {
                            
                            //console.log(days, hours, mins, secs);
                            var timeRem = this.houra + " hrs " + this.minutea + " mins " + this.seconda + " secs ";
                            //console.log(timeRem);
                        } else {
                            var timeRem = "Finally! The day has come.";
                        }
                        el.setAttribute('value', timeRem);
                    }, 1000);*/
                    
                },
                pause: function () {
                    this.pause=true;
                },
                play: function () {
                    if(this.pause)
                    {
                    this.TargetTime = new Date(new Date().getTime() + this.totalTimeRemaining); //calcute the new target time 
                    }
                    this.pause=false;
                }
            });</script>
  <body style="margin : 0px; overflow: hidden;">
    <a-scene embedded arjs>
      <!--<a-marker preset="hiro">
        <!-- we use cors proxy to avoid cross-origin problems 
        <a-entity
          position="0 0 0"
          scale="0.05 0.05 0.05"
          gltf-model="https://web-production-aa50.up.railway.app/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf"
        ></a-entity>
        
      </a-marker>-->

       <a-marker preset='hiro'>
                <!--<a-box position='0 0 0' material='color: red;'></a-box>-->
                <!--<a-plane scale = "4 2" position='0 0.1 0' rotation="-90 0 0" material='transparent:true;src:#invitation' controls></a-plane>-->
                <!--<a-entity text="font: https://cdn.aframe.io/fonts/mozillavr.fnt; value: Fun Moments"></a-entity>-->

                <a-plane scale="1 1" position="0 0.1 0" rotation="-90 0 0" src="#texture">
                    <a-text id="timer" clock-text value="00:00:00" width="1.5" height="1" position="-0.451 0.041 0.000" color="#000000"></a-text>
                </a-plane>

                
            </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>

